@echo off
echo [0;94m[PreStartup][0;0m Checking permissions...
net session >nul 2>&1
if %errorlevel% == 0 (
  goto errorAdmin
)
echo [0;94m[PreStartup][0;0m Checking internet connection...
ping www.google.com -n 1 -w 1000>nul
if errorlevel 1 (set internet=none& goto ErrorInternet) else (echo [0;94m[PreStartup][0;0m Connected)

setlocal EnableDelayedExpansion
mode con cols=120 lines=30
@echo off
echo Starting up...
echo [0;94m[Startup][0;33m Update Lib. switcher: build 9[0;0m
echo [0;94m[Startup][0;33m Switching from fireroth.netlify.app to fireroth.github.io[0;0m
cd Command_Miner_Data
cd Command_Miner_Update
echo [0;94m[Startup][0;0m Setting up update feature...
if not exist Update.bat echo cd.. ^& cd.. ^& curl https://fireroth.github.io/download/data/CommandMiner/latest^>CommandMiner.bat ^& cd Command_Miner_Data ^& cd Command_Miner_Update ^& start Updated.vbs ^& exit>Update.bat & goto update
cd..
goto updateVM

:update
del allcomm.bat &cd Command_Miner_Update & start /min Update.bat & exit
goto update

:ErrorAdmin
echo [0;31mAdministrator mode is not supported!
echo Command Miner cannot be loaded[0;0m
echo Press any key to exit . . . 
pause>nul
exit

:ErrorInternet
echo [0;31mSlow or no internet connection!
echo Command Miner cannot be loaded[0;0m
pause
exit

:updateVM
cd Command_Miner_Update
del update.bat
echo.
echo [0;94m[Update Library][0;0m Operation succeeded
echo [0;94m[Update Library][0;0m Command Miner will now close!
echo [0;94m[Update Library][0;0m Please reOpen Command Miner
echo [0;94m[Update Library][0;0m [NOTE]: This command was executed automatically
pause
exit